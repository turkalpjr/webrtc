{"ast":null,"code":"import socketClient from 'socket.io-client';\nimport store from '../../store/store';\nimport * as dashboardActions from '../../store/actions/dashboardActions';\nimport * as webRTCHandler from '../webRTC/webRTCHandler';\nconst SERVER = 'http://localhost:5000';\nconst broadcastEventTypes = {\n  ACTIVE_USERS: 'ACTIVE_USERS',\n  GROUP_CALL_ROOMS: 'GROUP_CALL_ROOMS'\n};\nlet socket;\nexport const connectWithWebSocket = () => {\n  socket = socketClient(SERVER);\n  socket.on('connection', () => {\n    console.log('SUCCESSFULLY CONNECTED WİTH WSS SERVER');\n    console.log(socket.id);\n  });\n  socket.on('broadcast', data => {\n    handleBroadcastEvents(data);\n  });\n  socket.on('pre-offer', data => {\n    webRTCHandler.handlePreOffer(data);\n  });\n  socket.on('pre-offer-answer', data => {\n    webRTCHandler.handlePreOfferAnswer(data);\n  });\n};\nexport const registerNewUser = username => {\n  socket.emit('register-new-user', {\n    username: username,\n    socketId: socket.id\n  });\n};\n\n// emitting events to server related with direct call\n\nexport const sendPreOffer = data => {\n  socket.emit('pre-offer', data);\n};\nexport const sendPreOfferAnswer = data => {\n  socket.emit('pre-offer-answer', data);\n};\nconst handleBroadcastEvents = data => {\n  switch (data.event) {\n    case broadcastEventTypes.ACTIVE_USERS:\n      const activeUsers = data.activeUsers.filter(activeUser => activeUser.socketId !== socket.id);\n      store.dispatch(dashboardActions.setActiveUsers(activeUsers));\n      break;\n    default:\n      break;\n  }\n};","map":{"version":3,"names":["socketClient","store","dashboardActions","webRTCHandler","SERVER","broadcastEventTypes","ACTIVE_USERS","GROUP_CALL_ROOMS","socket","connectWithWebSocket","on","console","log","id","data","handleBroadcastEvents","handlePreOffer","handlePreOfferAnswer","registerNewUser","username","emit","socketId","sendPreOffer","sendPreOfferAnswer","event","activeUsers","filter","activeUser","dispatch","setActiveUsers"],"sources":["D:/videotalker/video-talker-frontend/src/utils/wssConnection/wssConnection.js"],"sourcesContent":["import socketClient from 'socket.io-client';\r\nimport store from '../../store/store';\r\nimport * as dashboardActions from '../../store/actions/dashboardActions';\r\nimport * as webRTCHandler from '../webRTC/webRTCHandler';\r\n\r\n\r\nconst SERVER = 'http://localhost:5000';\r\n\r\nconst broadcastEventTypes = {\r\n    ACTIVE_USERS: 'ACTIVE_USERS',\r\n    GROUP_CALL_ROOMS: 'GROUP_CALL_ROOMS'\r\n}\r\n\r\nlet socket;\r\nexport const connectWithWebSocket = () => {\r\n    socket = socketClient(SERVER);\r\n    socket.on('connection', () => {\r\n        console.log('SUCCESSFULLY CONNECTED WİTH WSS SERVER');\r\n        console.log(socket.id);\r\n    });\r\n\r\n    socket.on('broadcast', (data) => {\r\n        handleBroadcastEvents(data)\r\n    })\r\n\r\n    socket.on('pre-offer',(data)=>{\r\n        webRTCHandler.handlePreOffer(data);\r\n    });\r\n    socket.on('pre-offer-answer',(data)=>{\r\n        webRTCHandler.handlePreOfferAnswer(data);\r\n    });\r\n};\r\n\r\n\r\nexport const registerNewUser = (username) => {\r\n    socket.emit('register-new-user', {\r\n        username: username,\r\n        socketId: socket.id\r\n    })\r\n};\r\n\r\n// emitting events to server related with direct call\r\n\r\nexport const sendPreOffer=(data)=>{\r\n    socket.emit('pre-offer',data);\r\n}\r\n\r\nexport const sendPreOfferAnswer=(data)=>{\r\n    socket.emit('pre-offer-answer',data);\r\n};\r\n\r\n\r\n\r\nconst handleBroadcastEvents = (data) => {\r\n    switch (data.event) {\r\n        case broadcastEventTypes.ACTIVE_USERS:\r\n            const activeUsers = data.activeUsers.filter(activeUser => activeUser.socketId !== socket.id);\r\n            store.dispatch(dashboardActions.setActiveUsers(activeUsers));\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n}"],"mappings":"AAAA,OAAOA,YAAY,MAAM,kBAAkB;AAC3C,OAAOC,KAAK,MAAM,mBAAmB;AACrC,OAAO,KAAKC,gBAAgB,MAAM,sCAAsC;AACxE,OAAO,KAAKC,aAAa,MAAM,yBAAyB;AAGxD,MAAMC,MAAM,GAAG,uBAAuB;AAEtC,MAAMC,mBAAmB,GAAG;EACxBC,YAAY,EAAE,cAAc;EAC5BC,gBAAgB,EAAE;AACtB,CAAC;AAED,IAAIC,MAAM;AACV,OAAO,MAAMC,oBAAoB,GAAG,MAAM;EACtCD,MAAM,GAAGR,YAAY,CAACI,MAAM,CAAC;EAC7BI,MAAM,CAACE,EAAE,CAAC,YAAY,EAAE,MAAM;IAC1BC,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC;IACrDD,OAAO,CAACC,GAAG,CAACJ,MAAM,CAACK,EAAE,CAAC;EAC1B,CAAC,CAAC;EAEFL,MAAM,CAACE,EAAE,CAAC,WAAW,EAAGI,IAAI,IAAK;IAC7BC,qBAAqB,CAACD,IAAI,CAAC;EAC/B,CAAC,CAAC;EAEFN,MAAM,CAACE,EAAE,CAAC,WAAW,EAAEI,IAAI,IAAG;IAC1BX,aAAa,CAACa,cAAc,CAACF,IAAI,CAAC;EACtC,CAAC,CAAC;EACFN,MAAM,CAACE,EAAE,CAAC,kBAAkB,EAAEI,IAAI,IAAG;IACjCX,aAAa,CAACc,oBAAoB,CAACH,IAAI,CAAC;EAC5C,CAAC,CAAC;AACN,CAAC;AAGD,OAAO,MAAMI,eAAe,GAAIC,QAAQ,IAAK;EACzCX,MAAM,CAACY,IAAI,CAAC,mBAAmB,EAAE;IAC7BD,QAAQ,EAAEA,QAAQ;IAClBE,QAAQ,EAAEb,MAAM,CAACK;EACrB,CAAC,CAAC;AACN,CAAC;;AAED;;AAEA,OAAO,MAAMS,YAAY,GAAER,IAAI,IAAG;EAC9BN,MAAM,CAACY,IAAI,CAAC,WAAW,EAACN,IAAI,CAAC;AACjC,CAAC;AAED,OAAO,MAAMS,kBAAkB,GAAET,IAAI,IAAG;EACpCN,MAAM,CAACY,IAAI,CAAC,kBAAkB,EAACN,IAAI,CAAC;AACxC,CAAC;AAID,MAAMC,qBAAqB,GAAID,IAAI,IAAK;EACpC,QAAQA,IAAI,CAACU,KAAK;IACd,KAAKnB,mBAAmB,CAACC,YAAY;MACjC,MAAMmB,WAAW,GAAGX,IAAI,CAACW,WAAW,CAACC,MAAM,CAACC,UAAU,IAAIA,UAAU,CAACN,QAAQ,KAAKb,MAAM,CAACK,EAAE,CAAC;MAC5FZ,KAAK,CAAC2B,QAAQ,CAAC1B,gBAAgB,CAAC2B,cAAc,CAACJ,WAAW,CAAC,CAAC;MAC5D;IACJ;MACI;EAAM;AAElB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}